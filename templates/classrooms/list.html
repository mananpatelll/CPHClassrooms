{% extends "base.html" %}
{% block title %}Classrooms{% endblock %}

{% block head_extra %}
<style>
  .tile { border:1px solid #ddd; border-radius:12px; overflow:hidden; background:#fff;
          box-shadow: 0 1px 2px rgba(0,0,0,.05); transition: transform .08s ease, box-shadow .08s ease; }
  .tile:hover { transform: translateY(-2px); box-shadow: 0 4px 16px rgba(0,0,0,.08); }
  .tile .ratio { background:#f3f4f6; }
  .tile-title { font-weight:600; font-size:0.98rem; text-align:center; margin:.5rem 0 0; }
  .tile-sub { font-size:.8rem; color:#6c757d; text-align:center; margin-bottom:.6rem; }
  .section-title { font-weight:700; text-align:center; font-size:1.5rem; margin:1.5rem 0 .75rem; }
  .img-cover { width:100%; height:100%; object-fit:cover; }
</style>
{% endblock %}

{% block content %}
<div class="container my-4">
  <h1 class="section-title">
    {% if building %}{{ building.name }}{% else %}All Classrooms{% endif %}
  </h1>

  <div class="row g-3">
    {% for r in rooms %}
      <div class="col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2">
        <a class="text-decoration-none text-reset" href="{% url 'classroom_detail' r.pk %}">
          <div class="tile h-100">
            {# templates/classrooms/list.html (inside the card image area) #}
              <div class="ratio ratio-16x9">
                {% if r.preview_image %}
                  <img src="{{ r.preview_image }}" alt="Preview of {{ r.building.name }} {{ r.room_number }}" class="img-cover" loading="lazy" decoding="async">
                {% else %}
                  {% with photo=r.photos.all|first %}
                    {% if photo and photo.image_url %}
                      <img src="{{ photo.image_url }}" alt="Preview of {{ r.building.name }} {{ r.room_number }}" class="img-cover" loading="lazy" decoding="async">
                    {% else %}
                      {% with pano=r.panoramas.all|first %}
                        {% if pano and pano.preview_url %}
                          <img src="{{ pano.preview_url }}" alt="Preview of {{ r.building.name }} {{ r.room_number }}" class="img-cover" loading="lazy" decoding="async">
                        {% elif pano and pano.image_url %}
                          <img src="{{ pano.image_url }}" alt="Preview of {{ r.building.name }} {{ r.room_number }}" class="img-cover" loading="lazy" decoding="async">
                        {% else %}
                          <div class="d-flex align-items-center justify-content-center text-muted" style="font-size:.85rem;">No preview</div>
                        {% endif %}
                      {% endwith %}
                    {% endif %}
                  {% endwith %}
                {% endif %}
              </div>

            <div class="px-3 pb-2 pt-2">
              <div class="tile-title">{{ r.building.name }} {{ r.room_number }}</div>
              <div class="tile-sub">Capacity: {{ r.capacity }}</div>
            </div>
          </div>
        </a>
      </div>
    {% empty %}
      <p>No classrooms found.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}
